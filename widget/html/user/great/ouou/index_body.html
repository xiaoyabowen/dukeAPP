<!DOCTYPE html>
<html lang="en" class="commonBg">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1,user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <title>欧来欧去</title>
    <link rel="stylesheet" href="../../../../css/api.css" />
    <link rel="stylesheet" href="../../../../css/commonWin.css" />
    <link rel="stylesheet" href="../../../../css/mui.min.css">
    <link rel="stylesheet" href="../../../../css/swiper.min.css">
    <link rel="stylesheet" href="../../../../css/modal.css">
    <link rel="stylesheet" href="../../../../css/greatCommon.css">
    <style>
        .tourism_main{
            background: #fff;
        }
        .tourism_title{
            height: auto !important;
        }
        .imgComDetail{
            display: block;
            width: 7rem;
        }
        .great_Price_List{
            margin: 0.2rem 0;

        }
    </style>
</head>
<body class="commonBg">


    <div class="Box">
        <div id="great" class="isDisplay">
            <div class="great_header">

                <div class="great_header_banner swiper-container">
                    <div class="swiper-wrapper">
                        <div class="swiper-slide" v-for="(imgSrc, index) in imgs" :key="index">
                            <img :src="imgSrc" />
                        </div>
                        <!--<div class="swiper-slide"><img src="../../../../image/bigWeigh/banner@2x.png" /></div>-->
                        <!--<div class="swiper-slide"><img src="../../../../image/circle/circle01.png" /></div>-->
                        <!--<div class="swiper-slide"><img src="../../../../image/circle/circle01.png" /></div>-->
                    </div>
                    <!-- Add Pagination -->
                    <div class="swiper-pagination"></div>
                </div>




                <div class="tourism_title">{{item.comName}}</div>
                <div class="great_Price_List cssFlex">
                    <span class="great_Price">¥{{item.priceRange}}</span>
                    <span class="great_Stock">商品已售: <span>{{total}}</span>件</span>
                </div>
                <div class="ouPersonDetail cssFlex" @click="tripDetail()">
                    <div class="ouPersonDetailText">
                        <div class="commonFont ouPersonLeft cssFlex">
                            <i>请选择</i>
                            <span class="tripPerson">出游人群</span>
                            <span class="tripCity">出发城市</span>
                            <span class="tripTime">时间</span>
                            <span class="tripNum">数量</span>
                            <span class="username isDisplay"></span>
                            <span class="userphone isDisplay"></span>
                            <span class="ouId isDisplay"></span>
                        </div>
                        <div class="commonSub24 ouPerson999">·全年保证出发·纯玩团·每周循环</div>
                    </div>
                    <img src="../../../../icon/right.png" alt="right" class="info-img-right">
                </div>
            </div>



            <div class="tourism_main">
                <div class="tourism_main_header hourse_main cssFlex">
                    <div><span @click="activeHandle('trip')" :class="active == 'trip' ? 'active' : ''">图文详情</span></div>
                    <div><span @click="activeHandle('immigrant')" :class="active == 'immigrant' ? 'active' : ''">费用说明</span></div>
                    <div><span @click="activeHandle('comNatural')" :class="active == 'comNatural' ? 'active' : ''">行程描述</span></div>
                    <div><span @click="activeHandle('uiNatural')" :class="active == 'uiNatural' ? 'active' : ''">预订须知</span></div>
                </div>

                <div id="trip" v-if="active == 'trip' && item.introduction">
                    <img v-for="(pic, index) in picList" :key="index" :src="pic" class="imgComDetail" alt="">
                </div>
                <div v-if="active == 'immigrant'">
                    <img v-for="(pic, index) in picListpic1" :key="index" :src="pic.img" class="imgComDetail" alt="">
                </div>

                <div v-if="active == 'comNatural' && item.intPic">
                    <img v-for="(pic, index) in picListpic2" :key="index" :src="pic" class="imgComDetail" alt="">
                </div>
                <div v-if="active == 'uiNatural'">
                    <img v-for="(pic, index) in picListpic3" :key="index" :src="pic.img" class="imgComDetail" alt="">
                </div>
            </div>

            <div class="great_immediately">
                <div class="great_immediately_comtent cssFlex">

                    <div class="purchaseLeft cssFlex">
                        <div class=" ousecoll ousecollBor cssFlex" @click="collectionHandleActive()" v-show="att">
                            <img src="../../../../image/great/Collection2x.png" alt="">
                            <span>收藏</span>
                        </div>
                        <div class=" ousecoll ousecollBor cssFlex" @click="collectionHandle()" v-show="!att">
                            <img src="../../../../image/great/Collection22x.png" alt="">
                            <span>收藏</span>
                        </div>
                        <div class=" ousecoll cssFlex" @click="callHandle()">
                            <img src="../../../../image/mine/phone.png" alt="">
                            <span>客服</span>
                        </div>


                    </div>
                    <div class="commodity_purchase cssFlex tourismou" @click="Consultation()">
                        <div>￥<i class="tripPrice">0</i>立即购买</div>
                    </div>
                </div>
            </div>

            <!--<img src="../../../../image/bigWeigh/feiyong1.png" alt="">-->
            <!--<component is="magicCube"></component>-->
        </div>
    </div>




    <script type="text/javascript" src="../../../../script/api.js"></script>
    <script type="text/javascript" src="../../../../script/rem.js"></script>
    <script type="text/javascript" src="../../../../script/apiCloud.js"></script>
    <script type="text/javascript" src="../../../../script/public.js"></script>
    <script type="text/javascript" src="../../../../script/jquery-1.8.1.min.js"></script>
    <script type="text/javascript" src="../../../../script/mui.min.js"></script>
    <script src="../../../../script/swiper.min.js"></script>
    <script type="text/javascript" src="../../../../script/data.js"></script>

    <script src="../../../../script/vue.min.js"></script>
    <script src="../../../../script/vuex.min.js"></script>

    <script src="https://cdn.bootcss.com/eruda/1.2.6/eruda.js"></script>
    <script>eruda.init();</script>
    <script>

    </script>

    <script>

        var winWidth,winHeight,url
        apiready = function () {
            winWidth = api.winWidth;
            winHeight = api.winHeight;
            url = api.pageParam.url
            // getSrceenWH(winWidth,winHeight)
            new Vue({
                el: '#great',
                data: {
                    active: 'trip',
                    item: {},
                    list: [],
                    len: 1,
                    total: "0",
                    picList: [],
                    picListpic1: [
                        {
                            img:'../../../../image/bigWeigh/feiyong1.png'
                        },
                        {
                            img:'../../../../image/bigWeigh/feiyong2.png'
                        },
                    ],
                    picListpic2: [],
                    picListpic3: [
                        {
                            img:'../../../../image/bigWeigh/yu1.png'
                        },
                        {
                            img:'../../../../image/bigWeigh/yu2.png'
                        },
                        {
                            img:'../../../../image/bigWeigh/yu3.png'
                        },
                        {
                            img:'../../../../image/bigWeigh/yu4.png'
                        },
                    ],
                    imgs: [],
                    att: false,
                    att_id: '',
                    person_id: '',
                    ouId: '',

                    cid: '9',
                    data: '',
                    username: '',
                    userphone: '',
                    userwx: '',
                    usermain: '',
                    showModal : false,


                },
                created: function () {
                    this.person_id = localStorage.getItem('person_id');
                    this.ouId = api.pageParam.ouId;
                    this.querySummaryByidoloq();
                },
                mounted: function () {
                    document.getElementById('great').classList.remove('isDisplay');
                    this.isDisplay = true;
                    //获得slider插件对象
                    var swiper = new Swiper('.swiper-container', {
                        pagination: {
                            el: '.swiper-pagination',
                        },
                        autoplay:true,
                    });
                    

                    
                },

                methods: {
                    // 获取数据
                    querySummaryByidoloq: function () {

                        var that = this;
                        ajaxGetWithProgress(querySummaryByidoloq, {
                            cid: that.ouId,
                            pid: that.person_id
                        }, function (data, err) {
                            console.log(data);
                            that.item = data.commodity
                            that.total = data.total
                            that.imgs = stringFun(data.commodity.placard)
                            that.picList = stringFun(data.commodity.introduction)
                            // that.picListpic1 = stringFun(data.commodity.intPic)
                            that.picListpic2 = stringFun(data.commodity.intPic)
                            // that.picListpic3 = stringFun(data.commodity.pic3)

                        });
                    },
                    // 切换tab
                    activeHandle: function (active) {
                        console.log(active)
                        this.active = active;
                    },
                    // 办理签证
                    // 收藏
                    collectionHandle: function () {
                        var uidUser = localStorage.getItem("user")
                        if (!uidUser){
                            openNewWindow("login", "../../../login/login.html");
                            return;
                        }
                        var that = this;
                        ajaxGet(collectComm, {
                            id: that.att_id,
                            ccStatus: 1,
                            pid: that.person_id,
                            commId: that.item.cId
                        }, function(data,err){
                            console.log(data);
                            if (data.commcollect) {
                                toast("编辑成功")
                                window.location.reload()
                            }
                        });
                        that.att = !that.att;
                    },
                    // 立即购买
                    Consultation: function () {
                        var that = this
                        if (document.querySelector(".tripPerson").innerText == "出游人群"){
                            toast("请先选择出游人群等信息")
                            return
                        }
                        if (document.querySelector(".tripPrice").innerText == "0"){
                            toast("请先选择出游人群等信息")
                            return
                        }
                        openNewWindow("confirmOrder", "../confirmOrder.html", {
                            url: 'tourism',
                            urlIs : 'tourismouou',
                            OrderKey : '',
                            ououPrice: document.querySelector(".tripPrice").innerText,
                            item: that.item,
                            order: {
                                num: that.total,
                                cId: document.querySelector("ouId").innerText,
                                summary: '',
                                price: document.querySelector(".tripPrice").innerText,
                                username: document.querySelector(".username").innerText,
                                userphone: document.querySelector(".userphone").innerText,
                            }
                        })
                    },
                    tripDetail : function () {
                        openNewWindow("tripDate", "./tripDate.html",{
                            name :'index'
                        });
                    },
                    // 唤起手机拨号功能
                    callHandle: function () {
                        api.call({
                            type: 'tel_prompt',
                            number: '17600016895'
                        });
                    },
                }
            })
        }

        function tripValue(tripPerson,oId,tripCity,dateActive,num,price,username,userphone) {
            console.log(oId)

            document.querySelector(".ouId").innerText = oId
            document.querySelector(".tripPerson").innerText = tripPerson
            document.querySelector(".tripCity").innerText = tripCity
            document.querySelector(".tripTime").innerText = dateActive
            document.querySelector(".tripNum").innerText = num +'人'
            document.querySelector(".tripPrice").innerText = price
            document.querySelector(".username").innerText = username
            document.querySelector(".userphone").innerText = userphone
        }


    </script>
<